# é‡æ„æ–¹æ¡ˆï¼šç»Ÿä¸€å ä½ç¬¦å’Œé‡æ–°ç”Ÿæˆé€»è¾‘

> **åˆ›å»ºæ—¶é—´**: 2026-02-01
> **çŠ¶æ€**: å¾…å®æ–½
> **ä¼˜å…ˆçº§**: é«˜

## ğŸ“‹ é‡æ„ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡

1. **ç»Ÿä¸€å ä½ç¬¦é€»è¾‘**ï¼šæ‰€æœ‰ç±»å‹ï¼ˆèŠå¤©ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰ä½¿ç”¨ç»Ÿä¸€çš„å ä½ç¬¦ç»„ä»¶
2. **ç»Ÿä¸€é‡æ–°ç”Ÿæˆé€»è¾‘**ï¼šå¤±è´¥/æˆåŠŸé‡æ–°ç”Ÿæˆç»Ÿä¸€ç®¡ç†ï¼Œæ˜“äºç»´æŠ¤
3. **æå‡å¯æ‰©å±•æ€§**ï¼šä¸ºæœªæ¥æ–°å¢æ¨¡å‹ï¼ˆéŸ³é¢‘ã€3Dç­‰ï¼‰åšå¥½å‡†å¤‡

### è®¾è®¡åŸåˆ™

- âœ… æ‰€æœ‰å ä½ç¬¦æ˜¾ç¤ºç»Ÿä¸€æ ·å¼ï¼šæ–‡å­— + ä¸‰ä¸ªè·³åŠ¨å°åœ†ç‚¹
- âœ… æ‰€æœ‰åª’ä½“å ä½ç¬¦æ˜¾ç¤ºç»Ÿä¸€æ ·å¼ï¼šç°è‰²æ¡† + å›¾æ ‡
- âœ… å¤±è´¥é‡æ–°ç”Ÿæˆç»Ÿä¸€åŸåœ°æ›¿æ¢
- âœ… æˆåŠŸé‡æ–°ç”Ÿæˆç›´æ¥è°ƒç”¨å‘é€æ¶ˆæ¯é€»è¾‘
- âœ… é¦–æ¬¡ç”Ÿæˆå’Œé‡æ–°ç”Ÿæˆä½¿ç”¨ç›¸åŒçš„å ä½ç¬¦æ–‡å­—

---

## ğŸ¯ æ–¹æ¡ˆä¸€ï¼šç»Ÿä¸€å ä½ç¬¦ç»„ä»¶

### 1.1 åˆ›å»º LoadingPlaceholder ç»„ä»¶

**æ–‡ä»¶**: `frontend/src/components/chat/LoadingPlaceholder.tsx`

```typescript
/**
 * ç»Ÿä¸€çš„åŠ è½½å ä½ç¬¦ç»„ä»¶
 *
 * æ˜¾ç¤ºæ–‡å­— + ä¸‰ä¸ªè·³åŠ¨çš„å°åœ†ç‚¹
 * é€‚ç”¨äºï¼šèŠå¤©ã€å›¾ç‰‡ã€è§†é¢‘ç­‰æ‰€æœ‰ç±»å‹çš„ç”Ÿæˆä¸­çŠ¶æ€
 */

import styles from './shared.module.css';

interface LoadingPlaceholderProps {
  /** å ä½ç¬¦æ–‡å­—ï¼ˆå¦‚ï¼š"AI æ­£åœ¨æ€è€ƒ"ã€"å›¾ç‰‡ç”Ÿæˆä¸­"ã€"è§†é¢‘ç”Ÿæˆä¸­"ï¼‰ */
  text: string;
  /** è‡ªå®šä¹‰æ ·å¼ç±»å */
  className?: string;
}

export default function LoadingPlaceholder({
  text,
  className = ''
}: LoadingPlaceholderProps) {
  return (
    <div className={`flex items-center space-x-2 text-gray-500 ${className}`}>
      <span className="text-sm">{text}</span>
      <div className="flex space-x-1">
        <span
          className={`w-2 h-2 bg-gray-400 rounded-full animate-bounce ${styles['bounce-dot-1']}`}
          aria-hidden="true"
        />
        <span
          className={`w-2 h-2 bg-gray-400 rounded-full animate-bounce ${styles['bounce-dot-2']}`}
          aria-hidden="true"
        />
        <span
          className={`w-2 h-2 bg-gray-400 rounded-full animate-bounce ${styles['bounce-dot-3']}`}
          aria-hidden="true"
        />
      </div>
    </div>
  );
}
```

### 1.2 åˆ›å»º MediaPlaceholder ç»„ä»¶

**æ–‡ä»¶**: `frontend/src/components/chat/MediaPlaceholder.tsx`

```typescript
/**
 * ç»Ÿä¸€çš„åª’ä½“å ä½ç¬¦ç»„ä»¶
 *
 * ç”¨äºæ˜¾ç¤ºåª’ä½“ç”Ÿæˆä¸­çš„ç°è‰²å ä½æ¡† + å›¾æ ‡
 * æ”¯æŒåŠ¨æ€å°ºå¯¸ã€æ·¡å…¥åŠ¨ç”»ã€æ·±è‰²æ¨¡å¼
 */

import { Image as ImageIcon, Video as VideoIcon, Music as MusicIcon, Box as BoxIcon } from 'lucide-react';
import styles from './shared.module.css';

/** åª’ä½“ç±»å‹ï¼ˆå¯æ‰©å±•ï¼‰ */
export type MediaType = 'image' | 'video' | 'audio' | '3d' | 'code';

/** åª’ä½“å ä½ç¬¦é…ç½® */
interface MediaPlaceholderConfig {
  icon: React.ComponentType<{ className?: string; 'aria-hidden'?: boolean }>;
  label: string;
  iconSize?: string;
}

/** åª’ä½“ç±»å‹é…ç½®æ˜ å°„ */
const MEDIA_CONFIG: Record<MediaType, MediaPlaceholderConfig> = {
  image: {
    icon: ImageIcon,
    label: 'æ­£åœ¨ç”Ÿæˆå›¾ç‰‡',
    iconSize: 'w-10 h-10',
  },
  video: {
    icon: VideoIcon,
    label: 'æ­£åœ¨ç”Ÿæˆè§†é¢‘',
    iconSize: 'w-10 h-10',
  },
  audio: {
    icon: MusicIcon,
    label: 'æ­£åœ¨ç”ŸæˆéŸ³é¢‘',
    iconSize: 'w-10 h-10',
  },
  '3d': {
    icon: BoxIcon,
    label: 'æ­£åœ¨ç”Ÿæˆ 3D æ¨¡å‹',
    iconSize: 'w-10 h-10',
  },
  code: {
    icon: ImageIcon,
    label: 'æ­£åœ¨ç”Ÿæˆä»£ç ',
    iconSize: 'w-10 h-10',
  },
};

interface MediaPlaceholderProps {
  /** åª’ä½“ç±»å‹ */
  type: MediaType;
  /** å ä½ç¬¦å®½åº¦ï¼ˆpxï¼‰ */
  width: number;
  /** å ä½ç¬¦é«˜åº¦ï¼ˆpxï¼‰ */
  height: number;
  /** è‡ªå®šä¹‰æ ·å¼ç±»å */
  className?: string;
}

export default function MediaPlaceholder({
  type,
  width,
  height,
  className = '',
}: MediaPlaceholderProps) {
  const config = MEDIA_CONFIG[type];
  const Icon = config.icon;
  const iconSize = config.iconSize || 'w-10 h-10';

  return (
    <div
      className={`
        ${styles['dynamic-size']}
        rounded-xl
        bg-gray-100 dark:bg-gray-700
        flex items-center justify-center
        shadow-sm
        animate-fade-in
        ${className}
      `}
      style={{
        '--width': `${width}px`,
        '--height': `${height}px`,
      } as React.CSSProperties}
      role="status"
      aria-label={config.label}
    >
      <Icon
        className={`${iconSize} text-gray-300 dark:text-gray-500`}
        aria-hidden="true"
      />
    </div>
  );
}

/**
 * è·å–åª’ä½“å ä½ç¬¦æ ‡ç­¾æ–‡å­—
 */
export function getMediaPlaceholderLabel(type: MediaType): string {
  return MEDIA_CONFIG[type]?.label || 'æ­£åœ¨ç”Ÿæˆ';
}
```

### 1.3 åˆ›å»ºå ä½ç¬¦å¸¸é‡æ–‡ä»¶

**æ–‡ä»¶**: `frontend/src/constants/placeholder.ts`

```typescript
/**
 * å ä½ç¬¦å¸¸é‡å’Œå·¥å…·å‡½æ•°
 * ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å ä½ç¬¦ç›¸å…³çš„æ–‡å­—å’Œé€»è¾‘
 */

import type { Message } from '../services/message';

/** æ¶ˆæ¯ç±»å‹ */
export type MessageType = 'chat' | 'image' | 'video' | 'audio' | '3d' | 'code';

/** å ä½ç¬¦æ–‡å­—å¸¸é‡ï¼ˆç»Ÿä¸€ç®¡ç†ï¼‰ */
export const PLACEHOLDER_TEXT = {
  // èŠå¤©å ä½ç¬¦ï¼ˆé¦–æ¬¡ç”Ÿæˆå’Œé‡æ–°ç”Ÿæˆéƒ½ç”¨è¿™ä¸ªï¼‰
  CHAT_THINKING: 'AI æ­£åœ¨æ€è€ƒ',

  // åª’ä½“å ä½ç¬¦ï¼ˆé¦–æ¬¡ç”Ÿæˆå’Œé‡æ–°ç”Ÿæˆéƒ½ç”¨è¿™ä¸ªï¼‰
  IMAGE_GENERATING: 'å›¾ç‰‡ç”Ÿæˆä¸­',
  VIDEO_GENERATING: 'è§†é¢‘ç”Ÿæˆä¸­',
  AUDIO_GENERATING: 'éŸ³é¢‘ç”Ÿæˆä¸­',
  MODEL_3D_GENERATING: '3D æ¨¡å‹ç”Ÿæˆä¸­',
  CODE_GENERATING: 'ä»£ç ç”Ÿæˆä¸­',
} as const;

/** åª’ä½“ç±»å‹åˆ°å ä½ç¬¦æ–‡å­—çš„æ˜ å°„ */
const MEDIA_PLACEHOLDER_MAP: Record<Exclude<MessageType, 'chat'>, string> = {
  image: PLACEHOLDER_TEXT.IMAGE_GENERATING,
  video: PLACEHOLDER_TEXT.VIDEO_GENERATING,
  audio: PLACEHOLDER_TEXT.AUDIO_GENERATING,
  '3d': PLACEHOLDER_TEXT.MODEL_3D_GENERATING,
  code: PLACEHOLDER_TEXT.CODE_GENERATING,
};

/**
 * è·å–å ä½ç¬¦æ–‡å­—ï¼ˆèŠå¤©/åª’ä½“é€šç”¨ï¼‰
 * @param type æ¶ˆæ¯ç±»å‹
 */
export function getPlaceholderText(type: MessageType): string {
  if (type === 'chat') {
    return PLACEHOLDER_TEXT.CHAT_THINKING;
  }
  return MEDIA_PLACEHOLDER_MAP[type];
}

/** å ä½ç¬¦åˆ¤æ–­ç»“æœ */
export interface PlaceholderInfo {
  isPlaceholder: boolean;
  type?: MessageType;
  text?: string;
}

/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºå ä½ç¬¦æ¶ˆæ¯
 */
export function getPlaceholderInfo(message: Message): PlaceholderInfo {
  const content = message.content;

  // æ£€æŸ¥å›¾ç‰‡å ä½ç¬¦
  if (content.includes(PLACEHOLDER_TEXT.IMAGE_GENERATING)) {
    return { isPlaceholder: true, type: 'image', text: content };
  }

  // æ£€æŸ¥è§†é¢‘å ä½ç¬¦
  if (content.includes(PLACEHOLDER_TEXT.VIDEO_GENERATING)) {
    return { isPlaceholder: true, type: 'video', text: content };
  }

  // æ£€æŸ¥éŸ³é¢‘å ä½ç¬¦
  if (content.includes(PLACEHOLDER_TEXT.AUDIO_GENERATING)) {
    return { isPlaceholder: true, type: 'audio', text: content };
  }

  // æ£€æŸ¥èŠå¤©å ä½ç¬¦ï¼ˆç©ºå†…å®¹ + streaming IDï¼‰
  if (!content && message.id.startsWith('streaming-')) {
    return { isPlaceholder: true, type: 'chat', text: PLACEHOLDER_TEXT.CHAT_THINKING };
  }

  return { isPlaceholder: false };
}

/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºåª’ä½“å ä½ç¬¦ï¼ˆå›¾ç‰‡/è§†é¢‘/éŸ³é¢‘ï¼‰
 */
export function isMediaPlaceholder(message: Message): boolean {
  const info = getPlaceholderInfo(message);
  return info.isPlaceholder && info.type !== 'chat';
}
```

---

## ğŸ¯ æ–¹æ¡ˆäºŒï¼šç»Ÿä¸€é‡æ–°ç”Ÿæˆé€»è¾‘

### 2.1 æ–‡ä»¶ç»“æ„

```
frontend/src/utils/regenerate/
â”œâ”€â”€ index.ts                    # ç»Ÿä¸€å…¥å£ï¼ˆregenerateMessageï¼‰
â”œâ”€â”€ regenerateInPlace.ts        # å¤±è´¥é‡æ–°ç”Ÿæˆï¼ˆåŸåœ°æ›¿æ¢ï¼‰
â”œâ”€â”€ regenerateAsNew.ts          # æˆåŠŸé‡æ–°ç”Ÿæˆï¼ˆæ¨¡æ‹Ÿå‘é€ï¼‰
â””â”€â”€ strategies/                 # ç±»å‹ç­–ç•¥
    â”œâ”€â”€ chatStrategy.ts         # èŠå¤©åŸåœ°é‡æ–°ç”Ÿæˆ
    â”œâ”€â”€ imageStrategy.ts        # å›¾ç‰‡åŸåœ°é‡æ–°ç”Ÿæˆ
    â””â”€â”€ videoStrategy.ts        # è§†é¢‘åŸåœ°é‡æ–°ç”Ÿæˆ
```

### 2.2 ç»Ÿä¸€å…¥å£

**æ–‡ä»¶**: `frontend/src/utils/regenerate/index.ts`

```typescript
/**
 * ç»Ÿä¸€é‡æ–°ç”Ÿæˆå…¥å£
 * è‡ªåŠ¨åˆ¤æ–­å¤±è´¥/æˆåŠŸï¼Œè°ƒç”¨å¯¹åº”ç­–ç•¥
 */

import { regenerateInPlace } from './regenerateInPlace';
import { regenerateAsNew } from './regenerateAsNew';
import type { Message, GenerationParams } from '../../services/message';

export type MessageType = 'chat' | 'image' | 'video';

export interface RegenerateMessageOptions {
  // æ¶ˆæ¯ä¿¡æ¯
  messageId: string;
  conversationId: string;
  targetMessage: Message;
  userMessage: Message;

  // çŠ¶æ€ç®¡ç†
  setMessages: React.Dispatch<React.SetStateAction<Message[]>>;
  setRegeneratingId: (id: string | null) => void;
  setIsRegeneratingAI: (value: boolean) => void;
  scrollToBottom: (smooth?: boolean) => void;
  userScrolledAway: boolean;

  // å›è°ƒ
  onSuccess?: (finalMessage: Message) => void;
  onError?: (error: string) => void;
  resetRegeneratingState: () => void;

  // ç±»å‹ç‰¹å®šå‚æ•°
  generationParams?: GenerationParams;
  conversationTitle?: string;

  // æˆåŠŸé‡æ–°ç”Ÿæˆéœ€è¦çš„å‘é€æ¶ˆæ¯å¤„ç†å™¨
  handleChatMessage?: (content: string, conversationId: string, imageUrl?: string | null) => Promise<void>;
  handleImageMessage?: (userMessage: Message) => Promise<void>;
  handleVideoMessage?: (userMessage: Message) => Promise<void>;
}

/**
 * ç»Ÿä¸€é‡æ–°ç”Ÿæˆå…¥å£
 * è‡ªåŠ¨åˆ¤æ–­å¤±è´¥/æˆåŠŸï¼Œè°ƒç”¨å¯¹åº”ç­–ç•¥
 */
export async function regenerateMessage(options: RegenerateMessageOptions): Promise<void> {
  const { targetMessage } = options;

  // 1. è‡ªåŠ¨åˆ¤æ–­æ¶ˆæ¯ç±»å‹
  const type = determineMessageType(targetMessage);

  // 2. æ ¹æ®æ˜¯å¦å¤±è´¥é€‰æ‹©ç­–ç•¥
  const isError = targetMessage.is_error === true;

  if (isError) {
    // å¤±è´¥æ¶ˆæ¯ï¼šåŸåœ°æ›¿æ¢
    await regenerateInPlace({
      ...options,
      type,
    });
  } else {
    // æˆåŠŸæ¶ˆæ¯ï¼šæ¨¡æ‹Ÿé‡æ–°å‘é€
    await regenerateAsNew({
      ...options,
      type,
    });
  }
}

/**
 * åˆ¤æ–­æ¶ˆæ¯ç±»å‹ï¼ˆä¼˜å…ˆçº§ï¼šå›¾ç‰‡ > è§†é¢‘ > èŠå¤©ï¼‰
 */
function determineMessageType(message: Message): MessageType {
  const hasImageUrl = !!message.image_url;
  const hasVideoUrl = !!message.video_url;
  const hasImageParams = !!message.generation_params?.image;
  const hasVideoParams = !!message.generation_params?.video;

  if (hasImageUrl || hasImageParams) return 'image';
  if (hasVideoUrl || hasVideoParams) return 'video';
  return 'chat';
}
```

### 2.3 å¤±è´¥é‡æ–°ç”Ÿæˆï¼ˆåŸåœ°æ›¿æ¢ï¼‰

**æ–‡ä»¶**: `frontend/src/utils/regenerate/regenerateInPlace.ts`

```typescript
/**
 * å¤±è´¥é‡æ–°ç”Ÿæˆï¼šåŸåœ°æ›¿æ¢
 * é€‚ç”¨äºæ‰€æœ‰ç±»å‹ï¼ˆèŠå¤©ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰
 */

import toast from 'react-hot-toast';
import { regenerateChatInPlace } from './strategies/chatStrategy';
import { regenerateImageInPlace } from './strategies/imageStrategy';
import { regenerateVideoInPlace } from './strategies/videoStrategy';
import type { RegenerateMessageOptions, MessageType } from './index';

interface RegenerateInPlaceOptions extends RegenerateMessageOptions {
  type: MessageType;
}

export async function regenerateInPlace({
  messageId,
  conversationId,
  targetMessage,
  userMessage,
  type,
  setMessages,
  setRegeneratingId,
  setIsRegeneratingAI,
  scrollToBottom,
  userScrolledAway,
  onSuccess,
  onError,
  resetRegeneratingState,
  generationParams,
  conversationTitle,
}: RegenerateInPlaceOptions): Promise<void> {

  // 1. ç»Ÿä¸€çš„å ä½é€»è¾‘ï¼ˆæ¸…ç©ºå†…å®¹ï¼Œè§¦å‘"æ­£åœ¨ç”Ÿæˆ"æ˜¾ç¤ºï¼‰
  setRegeneratingId(messageId);
  setIsRegeneratingAI(true);
  setMessages((prev) =>
    prev.map((m) => (m.id === messageId ? {
      ...m,
      content: '',
      is_error: false,
      image_url: null,
      video_url: null
    } : m))
  );

  try {
    // 2. æ ¹æ®ç±»å‹è°ƒç”¨å¯¹åº”ç­–ç•¥
    switch (type) {
      case 'chat':
        await regenerateChatInPlace({
          messageId,
          conversationId,
          setMessages,
          scrollToBottom,
          userScrolledAway,
          resetRegeneratingState,
          onSuccess,
        });
        break;

      case 'image':
        await regenerateImageInPlace({
          messageId,
          conversationId,
          userMessage,
          generationParams,
          conversationTitle,
          setMessages,
          scrollToBottom,
          resetRegeneratingState,
          onSuccess,
        });
        break;

      case 'video':
        await regenerateVideoInPlace({
          messageId,
          conversationId,
          userMessage,
          generationParams,
          conversationTitle,
          setMessages,
          scrollToBottom,
          resetRegeneratingState,
          onSuccess,
        });
        break;
    }
  } catch (error) {
    // 3. ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼ˆæ¢å¤åŸæ¶ˆæ¯ï¼‰
    setMessages((prev) => prev.map((m) => (m.id === messageId ? targetMessage : m)));
    resetRegeneratingState();

    const errorMsg = error instanceof Error ? error.message : 'é‡æ–°ç”Ÿæˆå¤±è´¥';
    onError?.(errorMsg);
    toast.error(errorMsg);
  }
}
```

### 2.4 æˆåŠŸé‡æ–°ç”Ÿæˆï¼ˆæ¨¡æ‹Ÿå‘é€ï¼‰

**æ–‡ä»¶**: `frontend/src/utils/regenerate/regenerateAsNew.ts`

```typescript
/**
 * æˆåŠŸé‡æ–°ç”Ÿæˆï¼šæ¨¡æ‹Ÿç”¨æˆ·é‡æ–°å‘é€
 * ç›´æ¥å¤ç”¨å‘é€æ¶ˆæ¯çš„é€»è¾‘
 */

import toast from 'react-hot-toast';
import type { RegenerateMessageOptions, MessageType } from './index';

interface RegenerateAsNewOptions extends RegenerateMessageOptions {
  type: MessageType;
}

export async function regenerateAsNew({
  userMessage,
  type,
  conversationId,
  handleChatMessage,
  handleImageMessage,
  handleVideoMessage,
}: RegenerateAsNewOptions): Promise<void> {

  try {
    switch (type) {
      case 'chat':
        if (!handleChatMessage) {
          throw new Error('ç¼ºå°‘ handleChatMessage å¤„ç†å™¨');
        }
        await handleChatMessage(
          userMessage.content,
          conversationId,
          userMessage.image_url || null
        );
        break;

      case 'image':
        if (!handleImageMessage) {
          throw new Error('ç¼ºå°‘ handleImageMessage å¤„ç†å™¨');
        }
        await handleImageMessage(userMessage);
        break;

      case 'video':
        if (!handleVideoMessage) {
          throw new Error('ç¼ºå°‘ handleVideoMessage å¤„ç†å™¨');
        }
        await handleVideoMessage(userMessage);
        break;
    }
  } catch (error) {
    const errorMsg = error instanceof Error ? error.message : 'é‡æ–°ç”Ÿæˆå¤±è´¥';
    toast.error(errorMsg);
    throw error;
  }
}
```

---

## ğŸ“ å®æ–½æ­¥éª¤

### é˜¶æ®µ 1ï¼šåˆ›å»ºæ–°ç»„ä»¶å’Œå·¥å…·å‡½æ•°

- [ ] åˆ›å»º `LoadingPlaceholder.tsx`
- [ ] åˆ›å»º `MediaPlaceholder.tsx`
- [ ] åˆ›å»º `constants/placeholder.ts`
- [ ] åˆ›å»º `utils/regenerate/` ç›®å½•ç»“æ„
- [ ] åˆ›å»ºç»Ÿä¸€é‡æ–°ç”Ÿæˆç›¸å…³æ–‡ä»¶

### é˜¶æ®µ 2ï¼šä¿®æ”¹ç°æœ‰ç»„ä»¶ä½¿ç”¨æ–°ç»„ä»¶

- [ ] ä¿®æ”¹ `MessageItem.tsx` ä½¿ç”¨ `LoadingPlaceholder`
- [ ] ä¿®æ”¹ `MessageMedia.tsx` ä½¿ç”¨ `MediaPlaceholder`
- [ ] ä¿®æ”¹ `MessageArea.tsx` ä½¿ç”¨ `regenerateMessage`
- [ ] æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç çš„å ä½ç¬¦æ–‡å­—

### é˜¶æ®µ 3ï¼šæ¸…ç†æ—§ä»£ç 

- [ ] åˆ é™¤ `useRegenerateAsNewMessage.ts`ï¼ˆé€»è¾‘å·²åˆå¹¶ï¼‰
- [ ] åˆ é™¤ `useRegenerateFailedMessage.ts`ï¼ˆé€»è¾‘å·²åˆå¹¶ï¼‰
- [ ] åˆ é™¤ `useRegenerateHandlers.ts`ï¼ˆé€»è¾‘å·²åˆå¹¶ï¼‰
- [ ] æ¸…ç† `MessageItem.tsx` ä¸­çš„æ—§å ä½ç¬¦ä»£ç 
- [ ] æ¸…ç† `MessageMedia.tsx` ä¸­çš„æ—§å ä½ç¬¦ä»£ç 

### é˜¶æ®µ 4ï¼šæµ‹è¯•éªŒè¯

- [ ] æµ‹è¯•èŠå¤©æ¶ˆæ¯ç”Ÿæˆå ä½ç¬¦æ˜¾ç¤º
- [ ] æµ‹è¯•å›¾ç‰‡æ¶ˆæ¯ç”Ÿæˆå ä½ç¬¦æ˜¾ç¤º
- [ ] æµ‹è¯•è§†é¢‘æ¶ˆæ¯ç”Ÿæˆå ä½ç¬¦æ˜¾ç¤º
- [ ] æµ‹è¯•èŠå¤©å¤±è´¥é‡æ–°ç”Ÿæˆ
- [ ] æµ‹è¯•å›¾ç‰‡å¤±è´¥é‡æ–°ç”Ÿæˆ
- [ ] æµ‹è¯•è§†é¢‘å¤±è´¥é‡æ–°ç”Ÿæˆ
- [ ] æµ‹è¯•èŠå¤©æˆåŠŸé‡æ–°ç”Ÿæˆ
- [ ] æµ‹è¯•å›¾ç‰‡æˆåŠŸé‡æ–°ç”Ÿæˆ
- [ ] æµ‹è¯•è§†é¢‘æˆåŠŸé‡æ–°ç”Ÿæˆ

---

## ğŸ“Š æ”¹è¿›å¯¹æ¯”

| ç»´åº¦ | é‡æ„å‰ | é‡æ„å |
|------|--------|--------|
| **å ä½ç¬¦æ–‡å­—** | åˆ†æ•£åœ¨ 8+ å¤„ | ç»Ÿä¸€åœ¨ 1 å¤„ âœ… |
| **å ä½ç¬¦æ ·å¼** | èŠå¤©æœ‰åŠ¨ç”»ï¼Œåª’ä½“æ— åŠ¨ç”» | å…¨éƒ¨ç»Ÿä¸€åŠ¨ç”» âœ… |
| **åª’ä½“å ä½æ¡†** | å›¾ç‰‡/è§†é¢‘é‡å¤ä»£ç  | ç»Ÿä¸€ç»„ä»¶ âœ… |
| **é‡æ–°ç”Ÿæˆé€»è¾‘** | 3 å¥—ç‹¬ç«‹å®ç° | 1 å¥—ç»Ÿä¸€é€»è¾‘ âœ… |
| **å¤±è´¥é‡æ–°ç”Ÿæˆ** | èŠå¤©ï¼šåŸåœ°æ›¿æ¢<br>å›¾ç‰‡/è§†é¢‘ï¼šæœ«å°¾æ–°å¢ | å…¨éƒ¨åŸåœ°æ›¿æ¢ âœ… |
| **æˆåŠŸé‡æ–°ç”Ÿæˆ** | ç‹¬ç«‹å®ç° | å¤ç”¨å‘é€é€»è¾‘ âœ… |
| **ä»£ç å¤ç”¨** | ä½ | é«˜ âœ… |
| **æ‰©å±•æ€§** | æ–°å¢æ¨¡å‹éœ€æ”¹å¤šå¤„ | åªéœ€é…ç½®æ˜ å°„ âœ… |

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

1. æ‰€æœ‰å ä½ç¬¦æ˜¾ç¤ºç»Ÿä¸€çš„æ–‡å­— + ä¸‰ä¸ªè·³åŠ¨å°åœ†ç‚¹
2. æ‰€æœ‰åª’ä½“å ä½ç¬¦æ˜¾ç¤ºç»Ÿä¸€çš„ç°è‰²æ¡† + å›¾æ ‡
3. å¤±è´¥é‡æ–°ç”Ÿæˆåœ¨åŸä½ç½®æ›¿æ¢ï¼ˆèŠå¤©ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰
4. æˆåŠŸé‡æ–°ç”Ÿæˆåœ¨æœ«å°¾æ–°å¢ï¼ˆå¤ç”¨å‘é€é€»è¾‘ï¼‰
5. é¦–æ¬¡ç”Ÿæˆå’Œé‡æ–°ç”Ÿæˆæ˜¾ç¤ºç›¸åŒçš„å ä½ç¬¦æ–‡å­—

### ä»£ç è´¨é‡éªŒæ”¶

1. æ— ç¡¬ç¼–ç çš„å ä½ç¬¦æ–‡å­—
2. æ— é‡å¤çš„å ä½ç¬¦ç»„ä»¶ä»£ç 
3. ç»Ÿä¸€çš„é‡æ–°ç”Ÿæˆå…¥å£å‡½æ•°
4. TypeScript ç±»å‹å®‰å…¨
5. æ—  ESLint è­¦å‘Š

---

## ğŸ”„ åç»­ä¼˜åŒ–

- [ ] æ·»åŠ å ä½ç¬¦ç»„ä»¶å•å…ƒæµ‹è¯•
- [ ] æ·»åŠ é‡æ–°ç”Ÿæˆé€»è¾‘å•å…ƒæµ‹è¯•
- [ ] æ”¯æŒæ›´å¤šåª’ä½“ç±»å‹ï¼ˆéŸ³é¢‘ã€3D ç­‰ï¼‰
- [ ] ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½
- [ ] æ”¯æŒå ä½ç¬¦ä¸»é¢˜è‡ªå®šä¹‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-02-01
